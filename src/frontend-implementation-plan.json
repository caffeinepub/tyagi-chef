{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Fix candidate status badge crash when status is missing/unknown",
  "requirements": [
    {
      "id": "REQ-19",
      "summary": "Make candidate status label/badge rendering resilient to undefined/unknown statuses across candidate list and detail screens to prevent `toUpperCase()` runtime crashes.",
      "acceptanceCriteria": [
        "Creating a new candidate no longer crashes the UI.",
        "CandidatesListPage and CandidateDetailPage do not call `toUpperCase()` on an undefined value (or otherwise throw) even if a candidate record has a missing/unknown status.",
        "When status is missing/unknown, the UI shows a safe fallback label (English text) instead of crashing."
      ],
      "file_operations": [
        {
          "path": "frontend/src/utils/candidateStatusPresentation.ts",
          "operation": "create",
          "description": "Create a small utility that converts an unknown/possibly-missing candidate status into a safe badge presentation (label + shadcn Badge variant), using a fallback label (e.g., \"UNKNOWN\") when the status is undefined/unrecognized."
        },
        {
          "path": "frontend/src/pages/candidates/CandidatesListPage.tsx",
          "operation": "modify",
          "description": "Replace the local `getStatusBadge` logic to use the new status presentation utility so the list never calls `toUpperCase()` on an undefined/unknown status; ensure the rendered Badge always has a safe label."
        },
        {
          "path": "frontend/src/pages/candidates/CandidateDetailPage.tsx",
          "operation": "modify",
          "description": "Replace the local `getStatusBadge` logic to use the new status presentation utility so the detail view never calls `toUpperCase()` on an undefined/unknown status; ensure the rendered Badge always has a safe label."
        }
      ]
    },
    {
      "id": "REQ-20",
      "summary": "Add frontend-side verification and graceful handling so newly created or legacy candidates missing status never cause runtime errors, while surfacing a safe fallback in the UI.",
      "acceptanceCriteria": [
        "New candidates created via the UI have a non-empty status when fetched from the backend.",
        "If any existing/legacy candidate data is missing status, the UI still renders candidate list/detail screens without errors."
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/candidates/CandidateCreatePage.tsx",
          "operation": "modify",
          "description": "After successful creation, perform a lightweight fetch/verification of the created candidate before/after navigation (using existing actor access patterns) to confirm `status` is present; if missing, do not crashâ€”optionally warn via toast/console while continuing with navigation and relying on the safe fallback rendering."
        },
        {
          "path": "frontend/src/pages/candidates/CandidatesListPage.tsx",
          "operation": "modify",
          "description": "Ensure any status-dependent UI logic (including status filter comparisons and badge rendering) remains safe even when candidate status is missing/unknown by relying on the shared status presentation utility and avoiding assumptions about runtime status shape."
        },
        {
          "path": "frontend/src/pages/candidates/CandidateDetailPage.tsx",
          "operation": "modify",
          "description": "Ensure any status-dependent UI logic remains safe even when candidate status is missing/unknown by relying on the shared status presentation utility and avoiding assumptions about runtime status shape."
        }
      ]
    }
  ]
}